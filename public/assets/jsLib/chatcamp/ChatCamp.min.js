!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("ChatCamp",[],t):"object"==typeof exports?exports.ChatCamp=t():e.ChatCamp=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=22)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(24),i=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function e(t){r(this,e)};s.prototype=(0,i.default)(),e.exports=s},function(e,t,n){"use strict";function r(e){return"[object Array]"===S.call(e)}function o(e){return"[object ArrayBuffer]"===S.call(e)}function i(e){return"undefined"!=typeof FormData&&e instanceof FormData}function s(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function a(e){return"string"==typeof e}function u(e){return"number"==typeof e}function c(e){return void 0===e}function l(e){return null!==e&&"object"==typeof e}function f(e){return"[object Date]"===S.call(e)}function d(e){return"[object File]"===S.call(e)}function p(e){return"[object Blob]"===S.call(e)}function h(e){return"[object Function]"===S.call(e)}function g(e){return l(e)&&h(e.pipe)}function y(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function m(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function v(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function b(e,t){if(null!==e&&void 0!==e)if("object"==typeof e||r(e)||(e=[e]),r(e))for(var n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}function _(){function e(e,n){"object"==typeof t[n]&&"object"==typeof e?t[n]=_(t[n],e):t[n]=e}for(var t={},n=0,r=arguments.length;n<r;n++)b(arguments[n],e);return t}function k(e,t,n){return b(t,function(t,r){e[r]=n&&"function"==typeof t?w(t,n):t}),e}var w=n(11),C=n(27),S=Object.prototype.toString;e.exports={isArray:r,isArrayBuffer:o,isBuffer:C,isFormData:i,isArrayBufferView:s,isString:a,isNumber:u,isObject:l,isUndefined:c,isDate:f,isFile:d,isBlob:p,isFunction:h,isStream:g,isURLSearchParams:y,isStandardBrowserEnv:v,forEach:b,merge:_,extend:k,trim:m}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(23),c=r(u),l=n(17),f=r(l),d=n(4),p=r(d),h=n(20),g=r(h),y=n(6),m=r(y),v=n(51),b=r(v),_=n(5),k=r(_),w=n(8),C=(r(w),n(52)),S=r(C),T=n(3),O=(r(T),n(53)),I=r(O),x=n(57),E=r(x),j=n(21),P=r(j),M=n(58),U=r(M),R=null,A=function(e){function t(e){var n;o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),s=t.getInstance();return s?(n=s,i(r,n)):(r.onlineUsers=new b.default,r.messages=[],r.channelListeners=[],r.dms={},r.rooms={},r.tick=setInterval(function(){var e=t.getInstance().GroupChannel.cachedChannels;for(var n in e){if(e[n].checkTypingStatus())for(var r in t.getInstance().getChannelListenersMap()){var o=t.getInstance().getChannelListenersMap()[r];o.onGroupChannelTypingStatusChanged(e[n])}}},1e3),r.app=new f.default(e),r.titleBlink=new S.default({interval:null,oldTitle:document.title,isOldTitle:!0,client:r}),r.inbox=new g.default,R=r,r)}return s(t,e),a(t,[{key:"createDm",value:function(e){return e.client=this,e._receivedFromServer=!1,new p.default(e)}},{key:"createRoom",value:function(e){return e.client=this,e._receivedFromServer=!1,new k.default(e)}},{key:"updateUserDisplayName",value:function(e,t){return this.user.updateDisplayNameOnServer(e,t)}},{key:"updateUserProfileUrl",value:function(e,t){return this.user.updateProfileUrlOnServer(e,t)}},{key:"updateUserAvatarUrl",value:function(e,t){return this.user.updateAvatarUrlOnServer(e,t)}},{key:"addChannelListener",value:function(e,t){this.channelListeners[e]=t}},{key:"getChannelListenersMap",value:function(){return this.channelListeners}},{key:"createUserListQuery",value:function(){return new U.default}}]),t}(c.default);A.getInstance=function(){return null===R?null:R},A.prototype.GroupChannel=I.default,A.prototype.Message=m.default,A.prototype.GroupChannelListQuery=P.default,A.prototype.ChannelListener=E.default,t.default=A},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),l=n(2),f=(r(l),n(8)),d=(r(f),function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.id=null,r.displayName=null,r.firstName=null,r.lastName=null,r.email=null,r.phoneNumber=null,r.profileUrl=null,r.avatarUrl=null,r.lastSeen=null,r.isSuspended=!1,r.checkAccessToken=!1,e.id&&(r.id=e.id),e.display_name&&(r.displayName=e.display_name),e.first_name&&(r.firstName=e.first_name),e.last_name&&(r.lastName=e.last_name),e.email&&(r.email=e.email),e.phone_number&&(r.phoneNumber=e.phone_number),e.profile_url&&(r.profileUrl=e.profile_url),e.avatar_url&&(r.avatarUrl=e.avatar_url),e.last_seen?r.lastSeen=e.last_seen:r.lastSeen=0,e.is_suspended&&(r.isSuspended=e.is_suspended),e.check_access_token&&(r.checkAccessToken=e.check_access_token),e.metadata&&(r.metadata=e.metadata),e.is_online?r.isOnline=e.is_online:r.isOnline=!1,r.client=n,i(r)}return s(t,e),a(t,[{key:"updateDisplayNameOnServer",value:function(e,t){var n={id:this.id,display_name:e},r={t:"users.update",d:n,l:t};this.client.transportManager.send(r)}},{key:"updateProfileUrlOnServer",value:function(e,t){var n={id:this.id,profile_url:e},r={t:"users.update",d:n,l:t};this.client.transportManager.send(r)}},{key:"updateAvatarUrlOnServer",value:function(e,t){var n={id:this.id,avatar_url:e},r={t:"users.update",d:n,l:t};this.client.transportManager.send(r)}},{key:"updateStatus",value:function(e){var t={status:e};this.client.transportManager.send({t:"users.updateStatus",d:t})}},{key:"updateSoundNotification",value:function(e){var t={sound:e};this.client.transportManager.send({t:"users.updateSoundNotification",d:t})}}]),t}(c.default));t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),l=n(3),f=(r(l),n(6)),d=r(f),p=n(18),h=r(p),g=n(19),y=r(g),m=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.client=e.client,n._receivedFromServer=e._receivedFromServer,e.id&&(n.id=e.id),n.members=e.members,n.lastMessage=e.lastMessage,n.createdBy=e.createdBy,n.typingIndicatorPublisher=new y.default({dm:n}),n.typingIndicatorListener=new h.default({dm:n}),e.messages?n.messages=e.messages:n.messages=[],n.threadId=e.threadId,n}return s(t,e),a(t,[{key:"getHistory",value:function(){this.client.transportManager.send({t:"dm.getHistory",d:{id:this.id,ref:this.messages.length?this.messages[0].id:null}})}},{key:"create",value:function(){var e=this;this.r=this.client.transportManager.send({t:"dm.create",d:{members:this.members}}),this.toFunc=function(t){e.id=t.dm.id,e.threadId=t.dm.id,window.setTimeout(function(){e.client.off("to."+e.r,e.toFunc)},0)},this.client.on("to."+this.r,this.toFunc)}},{key:"createMessage",value:function(e){e.client=this.client,e.type="dm",e._receivedFromServer=!1;var t=this;return e.thread=t,e.sender=this.client.user,new d.default(e)}}]),t}(c.default);t.default=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),l=n(6),f=r(l),d=n(18),p=r(d),h=n(19),g=r(h),y=n(3),m=(r(y),function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.id=e.id,n.type=e.type,n.name=e.name,n.client=e.client,n.historyComplete=!1,n.typingIndicatorPublisher=new g.default({room:n}),n.typingIndicatorListener=new p.default({room:n}),e.messages?n.messages=e.messages:n.messages=[],n}return s(t,e),a(t,[{key:"getHistory",value:function(){!1===this.historyComplete&&this.client.transportManager.send({t:"rooms.getHistory",d:{id:this.id,ref:this.messages.length?this.messages[0].id:null}})}},{key:"createMessage",value:function(e){e.client=this.client,e._receivedFromServer=!1;var t=this;return e.thread=t,e.type="room",e.sender=this.client.user,e.insertedAt=Math.floor((new Date).getTime()/1e3),new f.default(e)}}]),t}(c.default));t.default=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(3),a=r(s),u=n(2),c=(r(u),n(0)),l=(r(c),n(4)),f=(r(l),n(5)),d=(r(f),n(49)),p=(r(d),function(){function e(t){o(this,e),this.id=t.id,this.type=t.type,"attachment"===t.type?this.attachment=t.attachment:this.text=t.text,t.custom_type?this.customType=t.custom_type:this.customType="",t.metadata?this.metadata=t.metadata:this.metadata={},this.user=new a.default(t.user),this.insertedAt=t.inserted_at}return i(e,[{key:"getText",value:function(){return this.text}},{key:"getUser",value:function(){return this.user}}]),e}());t.default=p},function(e,t,n){"use strict";(function(t){function r(e,t){!o.isUndefined(e)&&o.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var o=n(1),i=n(30),s={"Content-Type":"application/x-www-form-urlencoded"},a={adapter:function(){var e;return"undefined"!=typeof XMLHttpRequest?e=n(12):void 0!==t&&(e=n(12)),e}(),transformRequest:[function(e,t){return i(t,"Content-Type"),o.isFormData(e)||o.isArrayBuffer(e)||o.isBuffer(e)||o.isStream(e)||o.isFile(e)||o.isBlob(e)?e:o.isArrayBufferView(e)?e.buffer:o.isURLSearchParams(e)?(r(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):o.isObject(e)?(r(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};a.headers={common:{Accept:"application/json, text/plain, */*"}},o.forEach(["delete","get","head"],function(e){a.headers[e]={}}),o.forEach(["post","put","patch"],function(e){a.headers[e]=o.merge(s)}),e.exports=a}).call(t,n(29))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),l=n(2),f=(r(l),n(4)),d=r(f),p=n(5),h=(r(p),n(6)),g=r(h),y=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.type=e.type,n.id=e.id,n.client=e.client,n.members=e.members,n}return s(t,e),a(t,[{key:"create",value:function(e){if("dm"===this.type)return new d.default(this);this.type}},{key:"createMessage",value:function(e){return e._receivedFromServer=!1,new g.default(e)}}]),t}(c.default);t.default=y},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(10).LOG,a=s.DEBUG,u=s.INFO,c=s.WARN,l=s.ERROR,f=s.NONE,d=Boolean(console.assert&&(console.assert.toString()||"").match(/assert/)),p=function(){function e(){r(this,e)}return i(e,[{key:"log",value:function(e,t,n,r){"object"===(void 0===e?"undefined":o(e))&&(t=e,e="");var i=(new Date).toLocaleTimeString(),s=void 0;switch(n){case a:s="debug";break;case u:s="info";break;case c:s="warn";break;case l:s="error";break;default:s="log"}t?d?console[s]("%ciFlyChat%c "+s.toUpperCase()+"%c ["+i+"]: "+e,"color: #888; font-weight: bold;","color: "+r,"color: black",t):console[s]("iFlyChat "+s.toUpperCase()+" ["+i+"]: "+e,t):d?console[s]("%ciFlyChat%c "+s.toUpperCase()+"%c ["+i+"]: "+e,"color: #888; font-weight: bold;","color: "+r,"color: black"):console[s]("iFlyChat "+s.toUpperCase()+" ["+i+"]: "+e)}},{key:"debug",value:function(e,t){this.level>=a&&this.log(e,t,a,"#888")}},{key:"info",value:function(e,t){this.level>=u&&this.log(e,t,u,"black")}},{key:"warn",value:function(e,t){this.level>=c&&this.log(e,t,c,"orange")}},{key:"error",value:function(e,t){this.level>=l&&this.log(e,t,l,"red")}}]),e}();p.prototype.level="undefined"==typeof jasmine?l:f;var h=new p;e.exports=h},function(e,t,n){"use strict";e.exports={SYNC_STATE:{NEW:"NEW",SAVING:"SAVING",SYNCING:"SYNCING",SYNCED:"SYNCED",LOADING:"LOADING"},RECIPIENT_STATE:{NONE:"NONE",SOME:"SOME",ALL:"ALL"},RECEIPT_STATE:{SENT:"sent",DELIVERED:"delivered",READ:"read",PENDING:"pending"},LOCALSTORAGE_KEYS:{SESSIONDATA:"iflychat-session-data-"},ACCEPT:"application/vnd.iflychat+json; version=2.0",WEBSOCKET_PROTOCOL:"iflychat-2.0",LOG:{DEBUG:4,INFO:3,WARN:2,ERROR:1,NONE:0},DELETION_MODE:{ALL:"all_participants",MY_DEVICES:"my_devices"},TYPING_STATE:{STARTED:"started",PAUSED:"paused",FINISHED:"finished"}}},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";var r=n(1),o=n(31),i=n(33),s=n(34),a=n(35),u=n(13),c="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(36);e.exports=function(e){return new Promise(function(t,l){var f=e.data,d=e.headers;r.isFormData(f)&&delete d["Content-Type"];var p=new XMLHttpRequest,h="onreadystatechange",g=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in p||a(e.url)||(p=new window.XDomainRequest,h="onload",g=!0,p.onprogress=function(){},p.ontimeout=function(){}),e.auth){var y=e.auth.username||"",m=e.auth.password||"";d.Authorization="Basic "+c(y+":"+m)}if(p.open(e.method.toUpperCase(),i(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p[h]=function(){if(p&&(4===p.readyState||g)&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in p?s(p.getAllResponseHeaders()):null,r=e.responseType&&"text"!==e.responseType?p.response:p.responseText,i={data:r,status:1223===p.status?204:p.status,statusText:1223===p.status?"No Content":p.statusText,headers:n,config:e,request:p};o(t,l,i),p=null}},p.onerror=function(){l(u("Network Error",e,null,p)),p=null},p.ontimeout=function(){l(u("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",p)),p=null},r.isStandardBrowserEnv()){var v=n(37),b=(e.withCredentials||a(e.url))&&e.xsrfCookieName?v.read(e.xsrfCookieName):void 0;b&&(d[e.xsrfHeaderName]=b)}if("setRequestHeader"in p&&r.forEach(d,function(e,t){void 0===f&&"content-type"===t.toLowerCase()?delete d[t]:p.setRequestHeader(t,e)}),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){p&&(p.abort(),l(e),p=null)}),void 0===f&&(f=null),p.send(f)})}},function(e,t,n){"use strict";var r=n(32);e.exports=function(e,t,n,o,i){var s=new Error(e);return r(s,t,n,o,i)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),l=r(c),f=n(46),d=r(f),p=n(9),h=r(p),g=n(2),y=(r(g),function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.client=e.client,n.heartbeatFrequency=3e4,n._nextHeartbeatId=0,n.open=!0,n.timesOpened=0,n._listeners={},n.host="wss://api.chatcamp.io",n.port="443",e.host&&(n.host=e.host),e.port&&(n.port=e.port),n.access_token=e.accessToken,n._r=0,e.accessToken?n._socket=new d.default(n.host+":"+n.port+"/chat/1.0?app_id="+n.client.app.id+"&user_id="+e.userId+"&access_token="+e.accessToken,{disableWebSocket:!1,disableEventSource:!0,disableXHRPolling:!1}):n._socket=new d.default(n.host+":"+n.port+"/chat/1.0?app_id="+n.client.app.id+"&user_id="+e.userId,{disableWebSocket:!1,disableEventSource:!0,disableXHRPolling:!1}),n._socket.onmessage=n._onMessage.bind(n),n._socket.onclose=n._onDisconnect.bind(n),n._socket.onopen=n._onOpen.bind(n),n._socket.onerror=n._onError.bind(n),n}return s(t,e),u(t,[{key:"setHost",value:function(e){this.host=e}},{key:"setPort",value:function(e){this.port=e}},{key:"_onOpen",value:function(){h.default.debug("chat socket: opened",this._socket.transportType),this.open=!0,this.timesOpened++,this._rescheduleHeartbeat(),this.emit("open")}},{key:"_onMessage",value:function(e){h.default.debug("chat socket: message",void 0===e?"undefined":a(e));var t=JSON.parse(e.data);this.emit("message",t),h.default.debug(t)}},{key:"_onDisconnect",value:function(){console.log("chat socket: disconnect"),this.open=!1,!0!==this.restrict&&setTimeout(function(){this.emit("reconnect",[iFlyChatUserSession.token])},1e3),this.emit("close")}},{key:"_onHeartbeat",value:function(){this.send({t:"ping"})}},{key:"_onClose",value:function(){console.log("chat socket: close")}},{key:"_onError",value:function(e){console.log("bullet: error",e);this._socket.transportType}},{key:"send",value:function(e){return this._r++,e.r=this._r,e.l&&(this._listeners["r_"+e.r]=e.l,delete e.l),this._socket.send(JSON.stringify(e)),this._r}},{key:"_rescheduleHeartbeat",value:function(){console.log(this._nextHeartbeatId),this._nextHeartbeatId&&clearTimeout(this._nextHeartbeatId),this._nextHeartbeatId=setTimeout(this._heartbeat.bind(this),this.heartbeatFrequency)}},{key:"_heartbeat",value:function(){this._nextHeartbeatId=0,this.send({t:"ping"}),this._rescheduleHeartbeat()}}]),t}(l.default));t.default=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),u=r(a),c=n(2),l=(r(c),function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return e.appId&&(n.id=e.appId),e.id&&(n.id=e.id),e.name&&(n.name=e.name),e.components&&(n.components=e.components),e.notification&&(n.notification=e.notification),e.client&&(n.client=e.client),n}return s(t,e),t}(u.default));t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(4),c=(r(u),n(5)),l=(r(c),n(3)),f=(r(l),n(0)),d=r(f),p=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.interval=5e3,e.dm?n.dm=e.dm:e.room&&(n.room=e.room),e.users?n.users=e.users:n.users=[],n.lastKeyId=0,n}return s(t,e),a(t,[{key:"set",value:function(e){var t=this;this.lastKeyId&&window.clearTimeout(this.lastKeyId),this.users=e,this.lastKeyId=window.setTimeout(function(){t.lastKeyId=0,t.users=[],t.dm?t.dm.client.emit("dm.typing.off",{id:t.dm.id}):t.room&&t.room.client.emit("rooms.typing.off",{id:t.room.id})},this.interval)}},{key:"reset",value:function(){this.lastKeyId&&window.clearTimeout(this.lastKeyId),this.lastKeyId=0,this.users=[],this.dm?this.dm.client.emit("dm.typing.off",{id:this.dm.id}):this.room&&this.room.client.emit("rooms.typing.off",{id:this.room.id})}}]),t}(d.default);t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),l=n(8),f=(r(l),n(4)),d=(r(f),n(5)),p=(r(d),n(10).TYPING_STATE),h=p.STARTED,g=(p.PAUSED,p.FINISHED),y=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return e.dm&&(n.dm=e.dm),e.room&&(n.room=e.room),n.input=null,n.lastKeyId=0,n._handleKeyPress=n._handleKeyPress.bind(n),n._handleKeyDown=n._handleKeyDown.bind(n),n}return s(t,e),a(t,[{key:"setInput",value:function(e){e!==this.input&&(this.removeInput(this.input),this.input=e,this.input.addEventListener("keypress",this._handleKeyPress),this.input.addEventListener("keydown",this._handleKeyDown))}},{key:"removeInput",value:function(e){e&&(e.removeEventListener("keypress",this._handleKeyPress),e.removeEventListener("keydown",this._handleKeyDown),this.input=null)}},{key:"_handleKeyPress",value:function(e){var t=this;this.lastKeyId&&window.clearTimeout(this.lastKeyId),this.lastKeyId=window.setTimeout(function(){t.lastKeyId=0;var e=!t.input.value;t.send(e?g:h)},50)}},{key:"_handleKeyDown",value:function(e){-1!==[8,46,13].indexOf(e.keyCode)&&this._handleKeyPress(e)}},{key:"send",value:function(e){this.dm?this.dm.client.transportManager.send({t:"dm.typing",d:{id:this.dm.id,state:e}}):this.room&&this.room.client.transportManager.send({t:"rooms.typing",d:{id:this.room.id,state:e}})}}]),t}(c.default);t.default=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),l=n(4),f=(r(l),function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.inbox=[],e}return s(t,e),a(t,[{key:"setInbox",value:function(e){for(var t in e)this.inbox.push(e[t])}},{key:"getInbox",value:function(){return this.inbox}},{key:"updateInbox",value:function(e){for(var t in this.inbox)this.inbox[t].id===e.id&&(!0,this.inbox[t]=e,this.inbox.splice(t,1));this.inbox.unshift(e)}}]),t}(c.default));t.default=f},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),s=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(){function e(){r(this,e),this.participantStateFilter=e.PARTICIPANT_STATE_ALL}return o(e,[{key:"setParticipantState",value:function(e){this.participantStateFilter=e}},{key:"get",value:function(e){var t=this,n=s.default.getInstance().transportManager.send({t:"group_channels.my_list",d:{participant_state_filter:this.participantStateFilter}});return this.toFunc=function(r){return window.setTimeout(function(){s.default.getInstance().off("to."+n,t.toFunc)},0),e(null,r)},s.default.getInstance().on("to."+n,this.toFunc),!0}}]),e}();a.PARTICIPANT_STATE_ALL="ALL",a.PARTICIPANT_STATE_INVITED="INVITED",a.PARTICIPANT_STATE_ACCEPTED="ACCEPTED",t.default=a},function(e,t,n){"use strict";var r=n(2).default;e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),l=r(c),f=n(9),d=r(f),p=n(25),h=r(p),g=n(45),y=r(g),m=n(16),v=r(m),b=n(48),_=r(b),k=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.devMode=!1,e.devMode&&(n.devMode=e.devMode),n.devMode?n.baseUrl="http://localhost:9080/api/1.0":n.baseUrl="https://api.chatcamp.io/api/1.0",h.default.defaults.withCredentials=!0,e.baseUrl&&(n.baseUrl=e.baseUrl),d.default.level=e.loglevel,n}return s(t,e),u(t,[{key:"authenticate",value:function(e,t,n){var r=this;h.default.get(this.baseUrl+"/csrf").then(function(o){console.log("csrf token",o.data.value),h.default.post(r.baseUrl+"/dashboardUsers.login",{app_id:e,email:t,password:n},{headers:{"Content-type":"application/json","X-CSRF-Token":o.data.value}}).then(function(t){console.log(t),"access_token"===t.data.token.name&&(r.app_id=e,r.access_token=t.data.token.value,y.default.set("access_token",r.access_token),y.default.set("app_id",r.app_id)),r.emit("authenticate.success",t.data)})})}},{key:"isStatePersist",value:function(){return!(!y.default.get("access_token")||!y.default.get("app_id"))&&(this.access_token=y.default.get("access_token"),this.app_id=y.default.get("app_id"),console.log(this.access_token,this.app_id),!0)}},{key:"connect",value:function(){2==arguments.length?"string"==typeof arguments[0]&&a("function"===arguments[1])&&this.connectUser(arguments[0],arguments[1]):3==arguments.length?"string"==typeof arguments[0]&&"string"==typeof arguments[1]&&a("function"===arguments[2])?this.connectUserWithAccessToken(arguments[0],arguments[1],arguments[2]):"string"==typeof arguments[0]&&void 0===arguments[1]&&a("function"===arguments[2])&&this.connectUser(arguments[0],arguments[2]):4==arguments.length?"string"==typeof arguments[0]&&"string"==typeof arguments[1]&&"string"==typeof arguments[2]&&"function"==typeof arguments[3]&&this.customConnectUser(arguments[0],arguments[1],arguments[2],arguments[3]):5==arguments.length&&("string"==typeof arguments[0]&&"string"==typeof arguments[1]&&"string"==typeof arguments[2]&&"string"==typeof arguments[3]&&"function"==typeof arguments[4]?this.customConnectUserWithAccessToken(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]):"string"==typeof arguments[0]&&void 0===arguments[1]&&"string"==typeof arguments[2]&&"string"==typeof arguments[3]&&"function"==typeof arguments[4]&&this.customConnectUser(arguments[0],arguments[2],arguments[3],arguments[4]))}},{key:"connectUser",value:function(e,t){return this._connect({userId:e},t)}},{key:"connectUserWithAccessToken",value:function(e,t,n){return this._connect({userId:e,accessToken:t},n)}},{key:"customConnectUser",value:function(e,t,n,r){return this.baseUrl="http://"+t+":"+n+"/api/1.0",t="ws://"+t,this._connect({userId:e,host:t,port:n},r)}},{key:"customConnectUserWithAccessToken",value:function(e,t,n,r,o){return this.baseUrl="http://"+n+":"+r+"/api/1.0",n="ws://"+n,this._connect({userId:e,accessToken:t,host:n,port:r},o)}},{key:"_connect",value:function(e,t){var n=this;this.callbackConnected=function(e){return n.off("users.auth",n.callbackConnected),t(null,e)},this.on("users.auth",this.callbackConnected),e.host&&e.port?e.accessToken?this.transportManager=new v.default({client:this,app_id:this.app.id,userId:e.userId,accessToken:e.accessToken,host:e.host,port:e.port}):this.transportManager=new v.default({client:this,app_id:this.app.id,userId:e.userId,host:e.host,port:e.port}):e.accessToken?this.transportManager=new v.default({client:this,app_id:this.app.id,userId:e.userId,accessToken:e.accessToken}):this.transportManager=new v.default({client:this,app_id:this.app.id,userId:e.userId}),this.eventManager=new _.default(this,this.transportManager)}},{key:"_uploadAttachment",value:function(e,t,n,r,o){console.log("function upload",e);var i=new FormData;i.append("app_id",this.app.id),i.append("user_id",this.user.id),i.append("channel_type",t),i.append("channel_id",n),i.append("attachment",e);var s={headers:{"content-type":"multipart/form-data"},onUploadProgress:function(e){r(e.loaded,e.total)}};h.default.post(this.baseUrl+"/attachment_upload",i,s).then(function(e){return e.data&&e.data.attachment?o(null,e.data.attachment):o(!0,null)}).catch(function(e){return o(e,null)})}},{key:"register",value:function(e,t,n,r,o,i){var s=this;console.log("web-sdk-register",e,t,n,r,o,i),h.default.get(this.baseUrl+"/csrf").then(function(a){console.log(a.data.value),h.default.post(s.baseUrl+"/dashboardUsers.register",{app_id:e,email:t,user_name:n,password:r,password_confirmation:o,recaptcha_response:i},{headers:{"Content-type":"application/json","X-CSRF-TOKEN":a.data.value}}).then(function(e){console.log(e),s.emit("register.success",e.data)})})}},{key:"logout",value:function(){var e=this;h.default.get(this.baseUrl+"/csrf").then(function(t){console.log(t.data.value),h.default.get(e.baseUrl+"/dashboardUsers.logout",{headers:{"Content-type":"application/json","X-CSRF-TOKEN":t.data.value}}).then(function(t){console.log(t),e.app_id="",e.access_token="",y.default.remove("access_token"),y.default.remove("app_id")})})}},{key:"passwordRecover",value:function(e,t){var n=this;h.default.get(this.baseUrl+"/csrf").then(function(r){console.log(r.data.value),h.default.post(n.baseUrl+"/dashboardUsers.recoverPassword",{app_id:e,email:t},{headers:{"Content-type":"application/json","X-CSRF-TOKEN":r.data.value}}).then(function(e){console.log(e),n.emit("password.recover.success",e.data)}).catch(function(t){console.log(t),n.emit("password.recover.error",e)})})}},{key:"passwordReset",value:function(e,t,n,r){var o=this;h.default.get(this.baseUrl+"/csrf").then(function(i){console.log(i.data.value),h.default.post(o.baseUrl+"/dashboardUsers.resetPassword",{app_id:e,reset_token:t,password:n,password_confirmation:r},{headers:{"Content-type":"application/json","X-CSRF-TOKEN":i.data.value}}).then(function(e){console.log(e),o.emit("password.reset.success",e.data)}).catch(function(t){console.log(t),o.emit("password.reset.error",e)})})}},{key:"emailConfirm",value:function(e,t){var n=this;h.default.get(this.baseUrl+"/csrf").then(function(r){console.log(r.data.value),h.default.get(n.baseUrl+"/dashboardUsers.confirm?confirmation_token="+t+"&app_id="+e,{},{headers:{"Content-type":"application/json","X-CSRF-TOKEN":r.data.value}}).then(function(e){console.log(e),n.emit("email.confirm.success",e.data)}).catch(function(t){console.log(t),n.emit("email.confirm.error",e)})})}},{key:"passwordResetAccess",value:function(e,t){var n=this;h.default.get(this.baseUrl+"/csrf").then(function(r){console.log(r.data.value),h.default.get(n.baseUrl+"/dashboardUsers.resetPassword?reset_token="+t+"&app_id="+e,{},{headers:{"Content-type":"application/json","X-CSRF-TOKEN":r.data.value}}).then(function(e){console.log(e),n.emit("password.resetAccess.success",e.data)}).catch(function(t){console.log(t),n.emit("password.resetAccess.error",e)})})}},{key:"appCreate",value:function(e,t,n,r,o,i){var s=this;h.default.get(this.baseUrl+"/csrf").then(function(a){console.log(a.data.value),h.default.post(s.baseUrl+"/app.create",{app_id:e,user_name:n,email:t,password:r,password_confirmation:o,recaptcha_response:i},{headers:{"Content-type":"application/json","X-CSRF-TOKEN":a.data.value}}).then(function(e){console.log(e),s.emit("app.create.success",e.data)})})}},{key:"appValid",value:function(e){var t=this;h.default.get(this.baseUrl+"/csrf").then(function(n){console.log(n.data.value),h.default.post(t.baseUrl+"/app.valid",{app_id:e},{headers:{"Content-type":"application/json","X-CSRF-TOKEN":n.data.value}}).then(function(e){console.log(e),t.emit("app.valid.success",e.data)}).catch(function(n){console.log(n),t.emit("app.valid.error",e)})})}},{key:"appInfo",value:function(e,t){var n=this;h.default.get(this.baseUrl+"/csrf").then(function(r){console.log(r.data.value),h.default.post(n.baseUrl+"/dashboardUsers.token",{app_id:e,email:t},{headers:{"Content-type":"application/json","X-CSRF-TOKEN":r.data.value}}).then(function(t){console.log(t.data.value),h.default.get(n.baseUrl+"/csrf").then(function(r){h.default.post(n.baseUrl+"/app.info",{app_id:e},{headers:{"Content-type":"application/json","X-CSRF-TOKEN":r.data.value,"X-Access-Token":t.data.value}}).then(function(e){console.log(e)})})})})}},{key:"saveSettings",value:function(e,t,n){var r=this;h.default.get(this.baseUrl+"/csrf").then(function(o){console.log("csrf token",o.data.value),h.default.post(r.baseUrl+"/settings.save",{id:e,fcm_api_key:t,fcm_sender_id:n},{headers:{"Content-type":"application/json","X-CSRF-Token":o.data.value}}).then(function(e){console.log(e),r.emit("saveSettings.success",e.data)})})}},{key:"fileUpload",value:function(e,t){var n=this;h.default.get(this.baseUrl+"/csrf").then(function(r){console.log(r.data.value),h.default.post(n.baseUrl+"/file.upload",{app_id:e,file:t},{headers:{"Content-type":"application/json","X-CSRF-TOKEN":r.data.value}}).then(function(e){console.log(e)})})}}]),t}(l.default);t.default=k},function(e,t,n){"use strict";function r(e){return e=e||Object.create(null),{on:function(t,n){(e[t]||(e[t]=[])).push(n)},off:function(t,n){e[t]&&e[t].splice(e[t].indexOf(n)>>>0,1)},emit:function(t,n){(e[t]||[]).map(function(e){e(n)}),(e["*"]||[]).map(function(e){e(t,n)})}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,n){e.exports=n(26)},function(e,t,n){"use strict";function r(e){var t=new s(e),n=i(s.prototype.request,t);return o.extend(n,s.prototype,t),o.extend(n,t),n}var o=n(1),i=n(11),s=n(28),a=n(7),u=r(a);u.Axios=s,u.create=function(e){return r(o.merge(a,e))},u.Cancel=n(15),u.CancelToken=n(43),u.isCancel=n(14),u.all=function(e){return Promise.all(e)},u.spread=n(44),e.exports=u,e.exports.default=u},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function r(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(n(e)||r(e)||!!e._isBuffer)}},function(e,t,n){"use strict";function r(e){this.defaults=e,this.interceptors={request:new s,response:new s}}var o=n(7),i=n(1),s=n(38),a=n(39),u=n(41),c=n(42);r.prototype.request=function(e){"string"==typeof e&&(e=i.merge({url:arguments[0]},arguments[1])),e=i.merge(o,this.defaults,{method:"get"},e),e.method=e.method.toLowerCase(),e.baseURL&&!u(e.url)&&(e.url=c(e.baseURL,e.url));var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},i.forEach(["delete","get","head","options"],function(e){r.prototype[e]=function(t,n){return this.request(i.merge(n||{},{method:e,url:t}))}}),i.forEach(["post","put","patch"],function(e){r.prototype[e]=function(t,n,r){return this.request(i.merge(r||{},{method:e,url:t,data:n}))}}),e.exports=r},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function i(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function s(){g&&p&&(g=!1,p.length?h=p.concat(h):y=-1,h.length&&a())}function a(){if(!g){var e=o(s);g=!0;for(var t=h.length;t;){for(p=h,h=[];++y<t;)p&&p[y].run();y=-1,t=h.length}p=null,g=!1,i(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var l,f,d=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var p,h=[],g=!1,y=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new u(e,t)),1!==h.length||g||o(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.prependListener=c,d.prependOnceListener=c,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e,t){r.forEach(e,function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])})}},function(e,t,n){"use strict";var r=n(13);e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e}},function(e,t,n){"use strict";function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var o=n(1);e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(o.isURLSearchParams(t))i=t.toString();else{var s=[];o.forEach(t,function(e,t){null!==e&&void 0!==e&&(o.isArray(e)&&(t+="[]"),o.isArray(e)||(e=[e]),o.forEach(e,function(e){o.isDate(e)?e=e.toISOString():o.isObject(e)&&(e=JSON.stringify(e)),s.push(r(t)+"="+r(e))}))}),i=s.join("&")}return i&&(e+=(-1===e.indexOf("?")?"?":"&")+i),e}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e){var t,n,o,i={};return e?(r.forEach(e.split("\n"),function(e){o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t&&(i[t]=i[t]?i[t]+", "+n:n)}),i):i}},function(e,t,n){"use strict";var r=n(1);e.exports=r.isStandardBrowserEnv()?function(){function e(e){var t=e;return n&&(o.setAttribute("href",t),t=o.href),o.setAttribute("href",t),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}var t,n=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");return t=e(window.location.href),function(n){var o=r.isString(n)?e(n):n;return o.protocol===t.protocol&&o.host===t.host}}():function(){return function(){return!0}}()},function(e,t,n){"use strict";function r(){this.message="String contains an invalid character"}function o(e){for(var t,n,o=String(e),s="",a=0,u=i;o.charAt(0|a)||(u="=",a%1);s+=u.charAt(63&t>>8-a%1*8)){if((n=o.charCodeAt(a+=.75))>255)throw new r;t=t<<8|n}return s}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.prototype=new Error,r.prototype.code=5,r.prototype.name="InvalidCharacterError",e.exports=o},function(e,t,n){"use strict";var r=n(1);e.exports=r.isStandardBrowserEnv()?function(){return{write:function(e,t,n,o,i,s){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(o)&&a.push("path="+o),r.isString(i)&&a.push("domain="+i),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(e,t,n){"use strict";function r(){this.handlers=[]}var o=n(1);r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){o.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=r},function(e,t,n){"use strict";function r(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var o=n(1),i=n(40),s=n(14),a=n(7);e.exports=function(e){return r(e),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=o.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),o.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||a.adapter)(e).then(function(t){return r(e),t.data=i(t.data,t.headers,e.transformResponse),t},function(t){return s(t)||(r(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e,t,n){return r.forEach(n,function(n){e=n(e,t)}),e}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new o(e),t(n.reason))})}var o=n(15);r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e;return{token:new r(function(t){e=t}),cancel:e}},e.exports=r},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){var r,o;!function(i){var s=!1;if(r=i,void 0!==(o="function"==typeof r?r.call(t,n,t,e):r)&&(e.exports=o),s=!0,e.exports=i(),s=!0,!s){var a=window.Cookies,u=window.Cookies=i();u.noConflict=function(){return window.Cookies=a,u}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(n){function r(t,o,i){var s;if("undefined"!=typeof document){if(arguments.length>1){if(i=e({path:"/"},r.defaults,i),"number"==typeof i.expires){var a=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*i.expires),i.expires=a}i.expires=i.expires?i.expires.toUTCString():"";try{s=JSON.stringify(o),/^[\{\[]/.test(s)&&(o=s)}catch(e){}o=n.write?n.write(o,t):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)),t=t.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),t=t.replace(/[\(\)]/g,escape);var u="";for(var c in i)i[c]&&(u+="; "+c,!0!==i[c]&&(u+="="+i[c]));return document.cookie=t+"="+o+u}t||(s={});for(var l=document.cookie?document.cookie.split("; "):[],f=/(%[0-9A-Z]{2})+/g,d=0;d<l.length;d++){var p=l[d].split("="),h=p.slice(1).join("=");'"'===h.charAt(0)&&(h=h.slice(1,-1));try{var g=p[0].replace(f,decodeURIComponent);if(h=n.read?n.read(h,g):n(h,g)||h.replace(f,decodeURIComponent),this.json)try{h=JSON.parse(h)}catch(e){}if(t===g){s=h;break}t||(s[g]=h)}catch(e){}}return s}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,n){r(t,"",e(n,{expires:-1}))},r.withConverter=t,r}return t(function(){})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(47),i=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(e,t){function n(){var t=0;for(var n in p){if(h===t){var r=p[n]();if(r){var o=new r.transport(e);return o.heart=r.heart,o}h++}t++}return!1}var o=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*n.length));return t},s=o(25)+(new Date).getTime(),a=0,u=1,c=2,l=3,f=e.replace("ws:","http:").replace("wss:","https:");if(e===f)if(void 0===t)var t={disableWebSocket:!0};else t.disableWebSocket=!0;var d=function(e){if(this.readyState!==a&&this.readyState!==u)return!1;var t=this;return i.default.post(f,e,{iflychat_token:s,content_type:"application/json"},function(e){e&&0!==e.length&&t.onmessage({data:e})}),!0},p={websocket:function(){var e=null;return(void 0===t||!t.disableWebSocket)&&(window.WebSocket&&(e=window.WebSocket),window.MozWebSocket&&-1===navigator.userAgent.indexOf("Firefox/6.0")&&(e=window.MozWebSocket),e?{heart:!0,transport:e}:null)},eventsource:function(){if(void 0!==t&&t.disableEventSource)return!1;if(!window.EventSource)return!1;var e=new window.EventSource(f);e.onopen=function(){n.readyState=u,n.onopen()},e.onmessage=function(e){n.onmessage(e)},e.onerror=function(){e.close(),e=void 0,n.onerror()};var n={readyState:a,send:d,close:function(){n.readyState=l,e.close(),e=void 0,n.onclose()}};return{heart:!1,transport:function(){return n}}},xhrPolling:function(){function e(){p=i.default.get(f,function(e){if(e){if(p=null,h.readyState===a&&(h.readyState=u,h.onopen(h)),e&&0!==e.length)if(console.log("Complete Data",e),"object"===(void 0===e?"undefined":r(e))){console.log("Normal Object",e);for(var t in e)h.onmessage({data:e[t]})}else console.log("2",e),h.onmessage({data:e});h.readyState===u&&n()}else p=null,h.onerror()},{iflychat_token:s})}function n(){c=setTimeout(function(){e()},100)}if(void 0!==t&&t.disableXHRPolling)return!1;var c,p=null;s=o(25)+(new Date).getTime();var h={readyState:a,send:d,close:function(){this.readyState=l,p&&(p.abort(),p=null),clearTimeout(c),h.onclose()},onopen:function(){},onmessage:function(){},onerror:function(){},onclose:function(){}};return n(),{heart:!1,transport:function(){return h}}}},h=0,g=new function(){function t(){if(i=!1,s=a,!(o=y?null:n()))return console.log("disconnect in bullet : !transport",h),f=d,h=0,g&&g.ondisconnect(),!1;o.onopen=function(){f=d,o.heart&&(r=setInterval(function(){g.onheartbeat()},2e4)),s!==u&&(s=u,g.onopen(),y=!0)},o.onclose=function(){console.log("disconnect in bullet : onclose",h),i||s===l||(o=null,clearInterval(r),s===c?(s=l,o=!1,g.onclose()):(s===a&&h++,f*=2,f>p&&(f=p),i=!0,setTimeout(function(){t()},f)))},o.onerror=o.onclose,o.onmessage=function(e){g.onmessage(e)}}var r,o,i=!0,s=l,f=80,d=80,p=1e4,y=!1;t(),this.onopen=function(){},this.onmessage=function(){},this.ondisconnect=function(){},this.onclose=function(){},this.onheartbeat=function(){},this.setURL=function(t){e=t},this.send=function(e){if(o){var t=o.send(e);return void 0===t||t}return!1},this.close=function(){s=c,o&&o.close()},this.transportType=h};return g};t.default=s},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){if("object"===(void 0===e?"undefined":r(e))){if(void 0!==e.token)return e=JSON.stringify(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}return e},i=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");return t>0||navigator.userAgent.match(/Trident.*rv\:11\./)?(console.log("IE"),parseInt(e.substring(t+5,e.indexOf(".",t)))):(console.log("otherbrowser"),!1)},s=function(e,t,n,s){var a=!1;if(i()&&window.XDomainRequest,1){var u=new XMLHttpRequest;u.open("POST",e,!0),u.withCredentials=!0,"application/x-www-form-urlencoded"===n?u.setRequestHeader("Content-type",n):"object"===(void 0===n?"undefined":r(n))?(u.setRequestHeader("Content-type",n.content_type),u.setRequestHeader("X-CSRF-TOKEN",n.csrf_token),n.access_token&&u.setRequestHeader("X-Access-Token",n.access_token),n.iflychat_token&&u.setRequestHeader("iflychat-token",n.iflychat_token),"string"!=typeof t&&"application/json"===n.content_type&&(t=JSON.stringify(t))):(u.setRequestHeader("Content-type","application/json"),"string"!=typeof t&&(t=JSON.stringify(t))),u.ontimeout=function(){a||(a=!0,s(!1))},u.timeout=5e4,u.onerror=function(){a||(a=!0,s(!1))},u.send(t),u.onreadystatechange=function(){if(4===u.readyState&&u.status>=200&&u.status<300)try{var e=JSON.parse(u.responseText);a||(a=!0,s(e))}catch(e){a||(a=!0,s("invalidTokenJSON"))}else 4===u.readyState&&(a||(a=!0,s(!1)))},u.onloadend=function(){}}else{alert(window.XDomainRequest);var c=new XDomainRequest;c.open("POST",e),c.ontimeout=function(){a||(a=!0,s(!1))},c.onprogress=function(){},c.onload=function(){try{var e=JSON.parse(c.responseText);null!=e&&void 0!==e||(e=JSON.parse(t.firstChild.textContent)),a||(a=!0,s(e))}catch(e){a||(a=!0,s("invalidTokenJSON"))}},c.onerror=function(){a||(a=!0,s(!1))},c.timeout=5e4,setTimeout(function(){c.send(o(t))},500)}},a=function(e,t,n){var o=!1;if(i()&&window.XDomainRequest,1){var s=new XMLHttpRequest;s.open("GET",e),s.withCredentials=!0,"object"===(void 0===n?"undefined":r(n))&&(n.iflychat_token&&s.setRequestHeader("iflychat-token",n.iflychat_token),s.setRequestHeader("x-csrf-token",n.csrf_token)),s.ontimeout=function(){o||(o=!0,t(!1))},s.onerror=function(){o||(o=!0,t(!1))},s.timeout=2e5,s.send(),s.onreadystatechange=function(){if(4===s.readyState&&s.status>=200&&s.status<300){var e=JSON.parse(s.responseText);o=!0,t(e)}else 4===s.readyState&&(o||(o=!0,t(!1)))},s.onloadend=function(){}}else{var a=new XDomainRequest;a.open("get",e),a.ontimeout=function(){o||(o=!0,t(!1))},a.onerror=function(){o||(o=!0,t(!1))},a.timeout=2e5,a.onload=function(){var e=JSON.parse(a.responseText);o=!0,t(e)},a.send()}};e.exports={post:s,get:a}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),l=n(17),f=r(l),d=n(2),p=r(d),h=n(4),g=(r(h),n(20)),y=(r(g),n(6)),m=r(y),v=n(5),b=r(v),_=n(16),k=(r(_),n(3)),w=r(k),C=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.client=e,r.transportManager=n,r.transportManager.on("message",r._handleMessage.bind(r)),r}return s(t,e),a(t,[{key:"_handleMessage",value:function(e){switch(e.t){case"app.get.ack":this._handleAppInfo(e);break;case"group_channels.create.ack":this._handleGroupChannelCreated(e.d,e.to);break;case"group_channels.history.ack":this._handleGroupChannelHistory(e.d,e.to);break;case"group_channels.get.ack":this._handleGroupChannelInfo(e.d,e.to);break;case"group_channels.update.ack":break;case"group_channels.update.pub":this._handleGroupChannelUpdatePub(e.d);break;case"group_channels.invite.ack":break;case"group_channels.accept.ack":this._handleGroupChannelAccepted(e.d,e.to);break;case"group_channels.accept.pub":case"group_channels.decline.ack":case"group_channels.leave.ack":case"group_channels.leave.pub":break;case"group_channels.my_list.ack":this._handleGroupChannelMyList(e.d,e.to);break;case"group_channels.message.ack":this._handleGroupChannelMessageSent(e.d,e.to);break;case"group_channels.message.pub":this._handleGroupChannelMessage(e.d,e.to);break;case"group_channels.start_typing.pub":this._handleGroupChannelStartTypingPub(e.d,e.to);break;case"group_channels.start_typing.ack":break;case"group_channels.stop_typing.pub":this._handleGroupChannelStopTypingPub(e.d,e.to);break;case"group_channels.stop_typing.ack":case"group_channels.read.ack":break;case"group_channels.read.pub":this._handleGroupChannelReadPub(e.d);break;case"users.auth.ack":this._handleUsersAuth(e.d,e.to);break;case"users.get.ack":case"users.update.ack":this._handleUsersInfo(e);break;case"users.list.ack":this._handleUsersList(e.d,e.to);break;default:this.client.emit(e.t,e.d)}}},{key:"_handleAppInfo",value:function(e){e.d.ok&&(this.client.app=new f.default({id:e.d.app.id,name:e.d.app.name,notification:e.d.app.notification,theme:e.d.app.theme,client:this.client}))}},{key:"_handleGroupChannelAccepted",value:function(e,t){if(e.ok){var n=e.group_channel,r=new(p.default.getInstance().GroupChannel)(n);t&&this.client.emit("to."+t,r)}}},{key:"_handleGroupChannelCreated",value:function(e,t){if(e.ok){var n=e.group_channel,r=new(p.default.getInstance().GroupChannel)(n);t&&this.client.emit("to."+t,r)}}},{key:"_handleGroupChannelHistory",value:function(e,t){if(e.ok){var n=e.messages,r=[];for(var o in n){var i=new m.default(n[o]);r.push(i)}t&&this.client.emit("to."+t,r)}}},{key:"_handleGroupChannelInfo",value:function(e,t){if(e.ok){var n=e.group_channel,r=new(p.default.getInstance().GroupChannel)(n);t&&this.client.emit("to."+t+".success",r)}else{e.error;t&&this.client.emit("to."+t+".error",e.error)}}},{key:"_handleGroupChannelUpdatePub",value:function(e){if(e.ok){var t=e.group_channel,n=new(p.default.getInstance().GroupChannel)(t);p.default.getInstance().GroupChannel.cachedChannels||(p.default.getInstance().GroupChannel.cachedChannels=[]),p.default.getInstance().GroupChannel.cachedChannels[n.getId()]=n,p.default.getInstance().GroupChannel.get(n.getId(),function(e,t){for(var n in p.default.getInstance().getChannelListenersMap()){p.default.getInstance().getChannelListenersMap()[n].onGroupChannelUpdated(t)}})}}},{key:"_handleGroupChannelMyList",value:function(e,t){if(e.ok){var n=e.group_channels,r=[];for(var o in n){var i=new(p.default.getInstance().GroupChannel)(n[o]);r.push(i)}t&&this.client.emit("to."+t,r)}}},{key:"_handleGroupChannelMessageSent",value:function(e,t){if(e.ok){var n=e.message,r=new m.default(n);n.channel_id;t&&this.client.emit("to."+t,r)}}},{key:"_handleGroupChannelMessage",value:function(e,t){if(e.ok){var n=e.message,r=new m.default(n),o=n.channel_id;p.default.getInstance().GroupChannel.get(o,function(e,t){t.lastMessage=r,t.unreadMessageCount+=1,p.default.getInstance().GroupChannel.cachedChannels||(p.default.getInstance().GroupChannel.cachedChannels=[]),p.default.getInstance().GroupChannel.cachedChannels[t.getId()]=t;for(var n in p.default.getInstance().getChannelListenersMap()){var o=p.default.getInstance().getChannelListenersMap()[n];o.onGroupChannelMessageReceived(t,r),o.onGroupChannelUpdated(t)}})}}},{key:"_handleGroupChannelStartTypingPub",value:function(e,t){if(e.ok){var n=e.group_channel.typing_participant_id,r=e.group_channel.id;p.default.getInstance().GroupChannel.get(r,function(e,t){t.setTypingStatus(n,!0);for(var r in p.default.getInstance().getChannelListenersMap()){p.default.getInstance().getChannelListenersMap()[r].onGroupChannelTypingStatusChanged(t)}})}}},{key:"_handleGroupChannelStopTypingPub",value:function(e,t){if(e.ok){var n=e.group_channel.typing_participant_id,r=e.group_channel.id;p.default.getInstance().GroupChannel.get(r,function(e,t){t.setTypingStatus(n,!1);for(var r in p.default.getInstance().getChannelListenersMap()){p.default.getInstance().getChannelListenersMap()[r].onGroupChannelTypingStatusChanged(t)}})}}},{key:"_handleGroupChannelReadPub",value:function(e){if(e.ok){var t=e.group_channel,n=new(p.default.getInstance().GroupChannel)(t);p.default.getInstance().GroupChannel.cachedChannels||(p.default.getInstance().GroupChannel.cachedChannels=[]),p.default.getInstance().GroupChannel.cachedChannels[n.getId()]=n,p.default.getInstance().GroupChannel.get(n.getId(),function(e,t){for(var n in p.default.getInstance().getChannelListenersMap()){p.default.getInstance().getChannelListenersMap()[n].onGroupChannelReadStatusUpdated(t)}})}}},{key:"_handleInboxInfo",value:function(e){e.d.ok&&(this.client.inbox.setInbox(e.d.inbox),this.client.emit(e.t,e.d))}},{key:"_handleInboxUpdate",value:function(e){e.d.ok&&(this.client.inbox.updateInbox(e.d.inbox),this.client.emit(e.t,e.d))}},{key:"_handleMessageDm",value:function(e){var t=this;if(e.d.ok){var n=!1;if(this.client.dms[e.d.message.thread_id]){n=!0;var r=!1,o=0;for(var i in this.client.dms[e.d.message.thread_id].messages)if(this.client.dms[e.d.message.thread_id].messages[i].id===e.d.message.id){r=!0,o=i;break}if(e.to)r&&this.client.dms[e.d.message.thread_id].messages.splice(o,1),this.client.emit("to."+e.to,e.d,e.to);else if(!r){var s={client:this.client,_receivedFromServer:!0,id:e.d.message.id,thread:this.client.dms[e.d.message.thread_id],text:e.d.message.text,sender:e.d.message.sender,type:"dm",insertedAt:e.d.message.inserted_at},a=new m.default(s);a.playSound(),this.client.dms[e.d.message.thread_id].typingIndicatorListener.reset(),this.client.titleBlink.changeTitle(e.d.message.sender.user_name,e.d.message.text),this.client.emit("message.dm",e.d)}}if(!n){var u=this.client.transportManager.send({t:"dm.info",d:{id:e.d.message.thread_id}});this.toFunc=function(e,n){t.client.dms[e.dm.id].getHistory(),t.client.user.setWindowState(e.dm.id,"dm","open"),window.setTimeout(function(){t.client.off("to."+n,t.toFunc)},0)},this.client.on("to."+u,this.toFunc)}}}},{key:"_handleMessageRooms",value:function(e){if(e.d.ok){if(this.client.rooms[e.d.message.thread_id]){!0;var t=!1,n=0;for(var r in this.client.rooms[e.d.message.thread_id].messages)if(this.client.rooms[e.d.message.thread_id].messages[r].id===e.d.message.id){t=!0,n=r;break}if(e.to)t&&this.client.rooms[e.d.message.thread_id].messages.splice(n,1),this.client.emit("to."+e.to,e.d);else if(!t){var o={client:this.client,_receivedFromServer:!0,id:e.d.message.id,thread:this.client.rooms[e.d.message.thread_id],text:e.d.message.text,sender:e.d.message.sender,type:"room",insertedAt:e.d.message.inserted_at},i=new m.default(o);e.d.message.sender.id!==this.client.user.id&&(i.playSound(),this.client.titleBlink.changeTitle(e.d.message.sender.user_name,e.d.message.text)),this.client.rooms[e.d.message.thread_id].typingIndicatorListener.reset(),this.client.emit("message.room",e.d)}}}}},{key:"_handleOnlineUsersInfo",value:function(e){e.d.ok&&(this.client.onlineUsers.setList(e.d.list),this.client.emit(e.t,e.d))}},{key:"_handleOnlineUsersJoin",value:function(e){e.d.ok&&(this.client.onlineUsers.joinList(e.d.user),this.client.emit("onlineUsers.info",{ok:!0,list:this.client.onlineUsers.getList()}))}},{key:"_handleOnlineUsersLeave",value:function(e){e.d.ok&&(this.client.onlineUsers.leaveList(e.d.user),this.client.emit("onlineUsers.info",{ok:!0,list:this.client.onlineUsers.getList()}))}},{key:"_handleRoomsList",value:function(e){if(e.d.ok)for(var t in e.d.rooms){var n=e.d.rooms[t],r={client:this.client,_receivedFromServer:!0,id:n.id,name:n.name,type:n.type};this.client.rooms[n.id]=new b.default(r);for(var o in this.client.user.windows){var i=this.client.user.windows[o];if("R"===n.type&&"room"===i.type&&n.id===i.id){i.thread=this.client.rooms[n.id],this.client.rooms[n.id].getHistory();break}}}this.client.emit(e.t,e.d)}},{key:"_handleRoomsHistory",value:function(e){if(e.d.ok){for(var t in e.d.rooms.messages)this._setMessageRoom(e.d.rooms.messages[t]);e.d.rooms.messages.length<20?this.client.rooms[e.d.rooms.id].historyComplete=!0:this.client.rooms[e.d.rooms.id].historyComplete=!1}this.client.emit(e.t,e.d)}},{key:"_handleRoomsTyping",value:function(e){if(e.d.ok&&this.client.rooms[e.d.id]&&this.client.user.id!==e.d.typing_users[0].id&&"started"===e.d.state){this.client.rooms[e.d.id].typingIndicatorListener.set(e.d.typing_users),this.client.emit("rooms.typing",e.d)}}},{key:"_handleUsersAuth",value:function(e,t){e.ok&&(this._setUser(e.user),t&&this.client.transportManager._listeners["r_"+t]&&(this.client.transportManager._listeners["r_"+t](null,this.client.user),delete this.client.transportManager._listeners["r_"+t]),this.client.emit("users.auth",this.client.user))}},{key:"_handleUsersInfo",value:function(e){if(e.d.ok&&e.d.user.id===this.client.user.id)this._handleUsersAuth(e);else if(e.d.ok&&e.d.user.id!==this.client.user.id){for(var t in this.client.onlineUsers.onlineUsers.global.users)if(this.client.onlineUsers.onlineUsers.global.users[t].id===e.d.user.id){this.client.onlineUsers.onlineUsers.global.users[t].status=e.d.user.status;break}}else this.client.emit(e.t,e.d)}},{key:"_handleUsersList",value:function(e,t){if(e.ok){var n=e.users,r=[];for(var o in n){var i=new w.default(n[o]);r.push(i)}t&&this.client.emit("to."+t,r)}}},{key:"_setUser",value:function(e){this.client.user=new w.default(e,this.client)}},{key:"_setMessageRoom",value:function(e){return new m.default({client:this.client,_receivedFromServer:!0,id:e.id,thread:this.client.rooms[e.thread_id],text:e.text,sender:e.sender,type:"room",insertedAt:e.inserted_at})}},{key:"_setMessageDm",value:function(e){return new m.default({client:this.client,_receivedFromServer:!0,id:e.id,thread:this.client.dms[e.thread_id],text:e.text,sender:e.sender,type:"dm",insertedAt:e.inserted_at})}}]),t}(c.default);t.default=C},function(e,t,n){(function(t){(function(){function t(e){this.tokens=[],this.tokens.links={},this.options=e||l.defaults,this.rules=f.normal,this.options.gfm&&(this.options.tables?this.rules=f.tables:this.rules=f.gfm)}function n(e,t){if(this.options=t||l.defaults,this.links=e,this.rules=d.normal,this.renderer=this.options.renderer||new r,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=d.breaks:this.rules=d.gfm:this.options.pedantic&&(this.rules=d.pedantic)}function r(e){this.options=e||{}}function o(e){this.tokens=[],this.token=null,this.options=e||l.defaults,this.options.renderer=this.options.renderer||new r,this.renderer=this.options.renderer,this.renderer.options=this.options}function i(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function s(e){return e.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/g,function(e,t){return t=t.toLowerCase(),"colon"===t?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function a(e,t){return e=e.source,t=t||"",function n(r,o){return r?(o=o.source||o,o=o.replace(/(^|[^\[])\^/g,"$1"),e=e.replace(r,o),n):new RegExp(e,t)}}function u(){}function c(e){for(var t,n,r=1;r<arguments.length;r++){t=arguments[r];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}function l(e,n,r){if(r||"function"==typeof n){r||(r=n,n=null),n=c({},l.defaults,n||{});var s,a,u=n.highlight,f=0;try{s=t.lex(e,n)}catch(e){return r(e)}a=s.length;var d=function(e){if(e)return n.highlight=u,r(e);var t;try{t=o.parse(s,n)}catch(t){e=t}return n.highlight=u,e?r(e):r(null,t)};if(!u||u.length<3)return d();if(delete n.highlight,!a)return d();for(;f<s.length;f++)!function(e){"code"!==e.type?--a||d():u(e.text,e.lang,function(t,n){return t?d(t):null==n||n===e.text?--a||d():(e.text=n,e.escaped=!0,void(--a||d()))})}(s[f])}else try{return n&&(n=c({},l.defaults,n)),o.parse(t.lex(e,n),n)}catch(e){if(e.message+="\nPlease report this to https://github.com/chjj/marked.",(n||l.defaults).silent)return"<p>An error occured:</p><pre>"+i(e.message+"",!0)+"</pre>";throw e}}var f={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:u,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:u,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:u,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};f.bullet=/(?:[*+-]|\d+\.)/,f.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,f.item=a(f.item,"gm")(/bull/g,f.bullet)(),f.list=a(f.list)(/bull/g,f.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+f.def.source+")")(),f.blockquote=a(f.blockquote)("def",f.def)(),f._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",f.html=a(f.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,f._tag)(),f.paragraph=a(f.paragraph)("hr",f.hr)("heading",f.heading)("lheading",f.lheading)("blockquote",f.blockquote)("tag","<"+f._tag)("def",f.def)(),f.normal=c({},f),f.gfm=c({},f.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),f.gfm.paragraph=a(f.paragraph)("(?!","(?!"+f.gfm.fences.source.replace("\\1","\\2")+"|"+f.list.source.replace("\\1","\\3")+"|")(),f.tables=c({},f.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),t.rules=f,t.lex=function(e,n){return new t(n).lex(e)},t.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},t.prototype.token=function(e,t,n){for(var r,o,i,s,a,u,c,l,d,e=e.replace(/^ +$/gm,"");e;)if((i=this.rules.newline.exec(e))&&(e=e.substring(i[0].length),i[0].length>1&&this.tokens.push({type:"space"})),i=this.rules.code.exec(e))e=e.substring(i[0].length),i=i[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?i:i.replace(/\n+$/,"")});else if(i=this.rules.fences.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"code",lang:i[2],text:i[3]||""});else if(i=this.rules.heading.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"heading",depth:i[1].length,text:i[2]});else if(t&&(i=this.rules.nptable.exec(e))){for(e=e.substring(i[0].length),u={type:"table",header:i[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:i[3].replace(/\n$/,"").split("\n")},l=0;l<u.align.length;l++)/^ *-+: *$/.test(u.align[l])?u.align[l]="right":/^ *:-+: *$/.test(u.align[l])?u.align[l]="center":/^ *:-+ *$/.test(u.align[l])?u.align[l]="left":u.align[l]=null;for(l=0;l<u.cells.length;l++)u.cells[l]=u.cells[l].split(/ *\| */);this.tokens.push(u)}else if(i=this.rules.lheading.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"heading",depth:"="===i[2]?1:2,text:i[1]});else if(i=this.rules.hr.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"hr"});else if(i=this.rules.blockquote.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"blockquote_start"}),i=i[0].replace(/^ *> ?/gm,""),this.token(i,t,!0),this.tokens.push({type:"blockquote_end"});else if(i=this.rules.list.exec(e)){for(e=e.substring(i[0].length),s=i[2],this.tokens.push({type:"list_start",ordered:s.length>1}),i=i[0].match(this.rules.item),r=!1,d=i.length,l=0;l<d;l++)u=i[l],c=u.length,u=u.replace(/^ *([*+-]|\d+\.) +/,""),~u.indexOf("\n ")&&(c-=u.length,u=this.options.pedantic?u.replace(/^ {1,4}/gm,""):u.replace(new RegExp("^ {1,"+c+"}","gm"),"")),this.options.smartLists&&l!==d-1&&(a=f.bullet.exec(i[l+1])[0],s===a||s.length>1&&a.length>1||(e=i.slice(l+1).join("\n")+e,l=d-1)),o=r||/\n\n(?!\s*$)/.test(u),l!==d-1&&(r="\n"===u.charAt(u.length-1),o||(o=r)),this.tokens.push({type:o?"loose_item_start":"list_item_start"}),this.token(u,!1,n),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(i=this.rules.html.exec(e))e=e.substring(i[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===i[1]||"script"===i[1]||"style"===i[1]),text:i[0]});else if(!n&&t&&(i=this.rules.def.exec(e)))e=e.substring(i[0].length),this.tokens.links[i[1].toLowerCase()]={href:i[2],title:i[3]};else if(t&&(i=this.rules.table.exec(e))){for(e=e.substring(i[0].length),u={type:"table",header:i[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:i[3].replace(/(?: *\| *)?\n$/,"").split("\n")},l=0;l<u.align.length;l++)/^ *-+: *$/.test(u.align[l])?u.align[l]="right":/^ *:-+: *$/.test(u.align[l])?u.align[l]="center":/^ *:-+ *$/.test(u.align[l])?u.align[l]="left":u.align[l]=null;for(l=0;l<u.cells.length;l++)u.cells[l]=u.cells[l].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(u)}else if(t&&(i=this.rules.paragraph.exec(e)))e=e.substring(i[0].length),this.tokens.push({type:"paragraph",text:"\n"===i[1].charAt(i[1].length-1)?i[1].slice(0,-1):i[1]});else if(i=this.rules.text.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"text",text:i[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var d={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:u,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:u,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};d._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,d._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,d.link=a(d.link)("inside",d._inside)("href",d._href)(),d.reflink=a(d.reflink)("inside",d._inside)(),d.normal=c({},d),d.pedantic=c({},d.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),d.gfm=c({},d.normal,{escape:a(d.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:a(d.text)("]|","~]|")("|","|https?://|")()}),d.breaks=c({},d.gfm,{br:a(d.br)("{2,}","*")(),text:a(d.gfm.text)("{2,}","*")()}),n.rules=d,n.output=function(e,t,r){return new n(t,r).output(e)},n.prototype.output=function(e){for(var t,n,r,o,s="";e;)if(o=this.rules.escape.exec(e))e=e.substring(o[0].length),s+=o[1];else if(o=this.rules.autolink.exec(e))e=e.substring(o[0].length),"@"===o[2]?(n=":"===o[1].charAt(6)?this.mangle(o[1].substring(7)):this.mangle(o[1]),r=this.mangle("mailto:")+n):(n=i(o[1]),r=n),s+=this.renderer.link(r,null,n);else if(this.inLink||!(o=this.rules.url.exec(e))){if(o=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(o[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(o[0])&&(this.inLink=!1),e=e.substring(o[0].length),s+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(o[0]):i(o[0]):o[0];else if(o=this.rules.link.exec(e))e=e.substring(o[0].length),this.inLink=!0,s+=this.outputLink(o,{href:o[2],title:o[3]}),this.inLink=!1;else if((o=this.rules.reflink.exec(e))||(o=this.rules.nolink.exec(e))){if(e=e.substring(o[0].length),t=(o[2]||o[1]).replace(/\s+/g," "),!(t=this.links[t.toLowerCase()])||!t.href){s+=o[0].charAt(0),e=o[0].substring(1)+e;continue}this.inLink=!0,s+=this.outputLink(o,t),this.inLink=!1}else if(o=this.rules.strong.exec(e))e=e.substring(o[0].length),s+=this.renderer.strong(this.output(o[2]||o[1]));else if(o=this.rules.em.exec(e))e=e.substring(o[0].length),s+=this.renderer.em(this.output(o[2]||o[1]));else if(o=this.rules.code.exec(e))e=e.substring(o[0].length),s+=this.renderer.codespan(i(o[2],!0));else if(o=this.rules.br.exec(e))e=e.substring(o[0].length),s+=this.renderer.br();else if(o=this.rules.del.exec(e))e=e.substring(o[0].length),s+=this.renderer.del(this.output(o[1]));else if(o=this.rules.text.exec(e))e=e.substring(o[0].length),s+=this.renderer.text(i(this.smartypants(o[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else e=e.substring(o[0].length),n=i(o[1]),r=n,s+=this.renderer.link(r,null,n);return s},n.prototype.outputLink=function(e,t){var n=i(t.href),r=t.title?i(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,r,this.output(e[1])):this.renderer.image(n,r,i(e[1]))},n.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014\/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014\/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},n.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,n="",r=e.length,o=0;o<r;o++)t=e.charCodeAt(o),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},r.prototype.code=function(e,t,n){if(this.options.highlight){var r=this.options.highlight(e,t);null!=r&&r!==e&&(n=!0,e=r)}return t?'<pre><code class="'+this.options.langPrefix+i(t,!0)+'">'+(n?e:i(e,!0))+"\n</code></pre>\n":"<pre><code>"+(n?e:i(e,!0))+"\n</code></pre>"},r.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},r.prototype.html=function(e){return e},r.prototype.heading=function(e,t,n){return"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},r.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},r.prototype.list=function(e,t){var n=t?"ol":"ul";return"<"+n+">\n"+e+"</"+n+">\n"},r.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},r.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},r.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},r.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},r.prototype.tablecell=function(e,t){var n=t.header?"th":"td";return(t.align?"<"+n+' style="text-align:'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},r.prototype.strong=function(e){return"<strong>"+e+"</strong>"},r.prototype.em=function(e){return"<em>"+e+"</em>"},r.prototype.codespan=function(e){return"<code>"+e+"</code>"},r.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},r.prototype.del=function(e){return"<del>"+e+"</del>"},r.prototype.link=function(e,t,n){if(this.options.sanitize){try{var r=decodeURIComponent(s(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return""}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:"))return""}var o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+=">"+n+"</a>"},r.prototype.image=function(e,t,n){var r='<img src="'+e+'" alt="'+n+'"';return t&&(r+=' title="'+t+'"'),r+=this.options.xhtml?"/>":">"},r.prototype.text=function(e){return e},o.parse=function(e,t,n){return new o(t,n).parse(e)},o.prototype.parse=function(e){this.inline=new n(e.links,this.options,this.renderer),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},o.prototype.next=function(){return this.token=this.tokens.pop()},o.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},o.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},o.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,r,o="",i="";for(n="",e=0;e<this.token.header.length;e++)({header:!0,align:this.token.align[e]}),n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(o+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",r=0;r<t.length;r++)n+=this.renderer.tablecell(this.inline.output(t[r]),{header:!1,align:this.token.align[r]});i+=this.renderer.tablerow(n)}return this.renderer.table(o,i);case"blockquote_start":for(var i="";"blockquote_end"!==this.next().type;)i+=this.tok();return this.renderer.blockquote(i);case"list_start":for(var i="",s=this.token.ordered;"list_end"!==this.next().type;)i+=this.tok();return this.renderer.list(i,s);case"list_item_start":for(var i="";"list_item_end"!==this.next().type;)i+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(i);case"loose_item_start":for(var i="";"list_item_end"!==this.next().type;)i+=this.tok();return this.renderer.listitem(i);case"html":var a=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(a);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},u.exec=u,l.options=l.setOptions=function(e){return c(l.defaults,e),l},l.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new r,xhtml:!1},l.Parser=o,l.parser=o.parse,l.Renderer=r,l.Lexer=t,l.lexer=t.lex,l.InlineLexer=n,l.inlineLexer=n.output,l.parse=l,e.exports=l}).call(function(){return this||("undefined"!=typeof window?window:t)}())}).call(t,n(50))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),c=r(u),l=n(3),f=r(l),d=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.onlineUsers={global:{users:[]}},e}return s(t,e),a(t,[{key:"setList",value:function(e){for(var t in e)this.onlineUsers.global.users.push(this.transform(e[t]))}},{key:"getList",value:function(){return this.onlineUsers.global.users}},{key:"joinList",value:function(e){for(var t=0;t<this.onlineUsers.global.users.length&&this.onlineUsers.global.users[t].id!==e.id;t++){if(e.user_name.toUpperCase()<this.onlineUsers.global.users[t].userName.toUpperCase()){this.onlineUsers.global.users.splice(t,0,this.transform(e));break}if(t===this.onlineUsers.global.users.length-1){this.onlineUsers.global.users.splice(t+1,0,this.transform(e));break}}}},{key:"leaveList",value:function(e){for(var t=0;t<this.onlineUsers.global.users.length;t++)if(this.onlineUsers.global.users[t].id===e.id){this.onlineUsers.global.users.splice(t,1);break}}},{key:"transform",value:function(e){return new f.default({id:e.id,type:e.type,status:e.status,appId:e.app_id,userName:e.user_name,email:e.email,avatarUrl:e.avatar_url})}}]),t}(c.default);t.default=d},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),u=function(e){return e&&e.__esModule?e:{default:e}}(a),c=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return e&&(n.name=e.name,n.title=e.title,n.oldTitle=e.oldTitle,n.interval=e.interval,n.isOldTitle=e.isOldTitle,n.client=e.client),window.onfocus=function(){this.clearTitle()}.bind(n),n}return i(t,e),s(t,[{key:"changeTitle",value:function(e,t){var n=this;this.name=e,this.title=t,"string"!=typeof this.title&&(this.title=this.title.join(" ")),this.title=this.name+" says: "+this.title.substring(0,8)+"...",null!==this.interval?(clearInterval(this.interval),this.interval=null,document.title=this.oldTitle,this.interval=setInterval(function(){document.title=n.isOldTitle?n.oldTitle:n.title,n.isOldTitle=!n.isOldTitle},2e3)):this.interval=setInterval(function(){document.title=n.isOldTitle?n.oldTitle:n.title,n.isOldTitle=!n.isOldTitle},2e3)}},{key:"clearTitle",value:function(){clearInterval(this.interval),this.interval=null,document.title=this.oldTitle}}]),t}(u.default);t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(2),a=r(s),u=n(54),c=r(u),l=n(21),f=r(l),d=n(55),p=r(d),h=n(56),g=r(h),y=n(6),m=r(y),v=function(){function e(t){if(o(this,e),t.id&&(this.id=t.id),t.name&&(this.name=t.name),t.data&&(this.data=t.data),t.avatar_url&&(this.avatarUrl=t.avatar_url),t.participants){this.participants=[];for(var n in t.participants)this.participants.push(new g.default(t.participants[n]))}t.participants_count?this.participantsCount=t.participants_count:this.participantsCount=0,t.custom_filter&&(this.customFilter=t.custom_filter),t.unread_message_count?this.unreadMessageCount=t.unread_message_count:this.unreadMessageCount=0,t.last_message&&(this.lastMessage=new m.default(t.last_message)),t.is_distinct?this.isDistinct=t.is_distinct:this.isDistinct=!1,t.read_receipt&&(this.readReceipt=t.read_receipt),t.is_archive&&(this.isArchive=t.isArchive),t.inserted_at&&(this.insertedAt=this.inserted_at),t.created_by&&(this.createdBy=t.created_by),t.updated_at&&(this.updatedAt=t.updated_at),t.metadata&&(this.metadata=t.metadata),this.cachedParticipantsTypingStatus=[],this.lastStartTyping=0,this.lastStopTyping=0}return i(e,[{key:"sync",value:function(e){var t=this,n=a.default.getInstance().transportManager.send({t:"group_channels.get",d:{id:this.id}});return this.toSuccessFunc=function(r){return a.default.getInstance().GroupChannel.cachedChannels[r.getId()]=r,window.setTimeout(function(){a.default.getInstance().off("to."+n+".success",t.toSuccessFunc),a.default.getInstance().off("to."+n+".error",t.toErrorFunc)},0),e(null,r)},this.toErrorFunc=function(r){var o=new c.default(r);return window.setTimeout(function(){a.default.getInstance().off("to."+n+".success",t.toSuccessFunc),a.default.getInstance().off("to."+n+".error",t.toErrorFunc)},0),e(o,null)},a.default.getInstance().on("to."+n+".success",this.toSuccessFunc),a.default.getInstance().on("to."+n+".error",this.toErrorFunc),!0}},{key:"inviteParticipants",value:function(e,t){var n=this,r=a.default.getInstance().transportManager.send({t:"group_channels.invite",d:{id:id,participant_ids:e}});return this.toFunc=function(e){return a.default.getInstance().GroupChannel.cachedChannels[e.getId()]=e,window.setTimeout(function(){a.default.getInstance().off("to."+r,n.toFunc)},0),t(null)},a.default.getInstance().on("to."+r,this.toFunc),!0}},{key:"inviteParticipant",value:function(e,t){return this.inviteParticipants([e],t)}},{key:"acceptInvitation",value:function(e){var t=this,n=a.default.getInstance().transportManager.send({t:"group_channels.accept",d:{id:this.id}});return this.toFunc=function(r){return a.default.getInstance().GroupChannel.cachedChannels[r.getId()]=r,window.setTimeout(function(){a.default.getInstance().off("to."+n,t.toFunc)},0),e(null)},a.default.getInstance().on("to."+n,this.toFunc),!0}},{key:"leave",value:function(e){var t=this,n=a.default.getInstance().transportManager.send({t:"group_channels.leave",d:{id:id}});return this.toFunc=function(r){return a.default.getInstance().GroupChannel.cachedChannels[r.getId()]=r,window.setTimeout(function(){a.default.getInstance().off("to."+n,t.toFunc)},0),e(null)},a.default.getInstance().on("to."+n,this.toFunc),!0}},{key:"declineInvitation",value:function(e){var t=this,n=a.default.getInstance().transportManager.send({t:"group_channels.decline",d:{id:id}});return this.toFunc=function(r){return a.default.getInstance().GroupChannel.cachedChannels[r.getId()]=r,window.setTimeout(function(){a.default.getInstance().off("to."+n,t.toFunc)},0),e(null)},a.default.getInstance().on("to."+n,this.toFunc),!0}},{key:"sendMessage",value:function(e,t,n,r){return r?this._sendMessage({message:e,metadata:t,customType:n},r):n?this._sendMessage({message:e,metadata:t},n):!!t&&this._sendMessage({message:e},t)}},{key:"_sendMessage",value:function(e,t){var n=this,r={id:this.id,text:e.message,type:"text"};e.metadata&&(r.metadata=e.metadata),e.customType&&(r.custom_type=e.customType);var o=a.default.getInstance().transportManager.send({t:"group_channels.message",d:r});return this.toFunc=function(e){return window.setTimeout(function(){a.default.getInstance().off("to."+o,n.toFunc)},0),t(null,e)},a.default.getInstance().on("to."+o,this.toFunc),!0}},{key:"sendAttachment",value:function(e,t,n){var r=this;a.default.getInstance()._uploadAttachment(e,"group_channel",this.id,t,function(e,t){if(e)return n(e,null);var o=a.default.getInstance().transportManager.send({t:"group_channels.message",d:{id:r.id,type:"attachment",attachment:t}});return r.toFunc=function(e){return window.setTimeout(function(){a.default.getInstance().off("to."+o,r.toFunc)},0),n(null,e)},a.default.getInstance().on("to."+o,r.toFunc),!0})}},{key:"isTyping",value:function(){return Object.keys(this.cachedParticipantsTypingStatus).length>0}},{key:"setTypingStatus",value:function(e,t){t?this.cachedParticipantsTypingStatus[e]=(new Date).getTime():delete this.cachedParticipantsTypingStatus[e]}},{key:"checkTypingStatus",value:function(){var e=!1;for(var t in this.cachedParticipantsTypingStatus)this.cachedParticipantsTypingStatus[t]<(new Date).getTime()-1e4&&(delete this.cachedParticipantsTypingStatus[t],e=!0);return e}},{key:"startTyping",value:function(){var e=this;if(this.lastStartTyping<(new Date).getTime()-1e4){var t=a.default.getInstance().transportManager.send({t:"group_channels.start_typing",d:{id:this.id}});return this.toFunc=function(n){return window.setTimeout(function(){a.default.getInstance().off("to."+t,e.toFunc)},0),cb(null,n)},this.lastStartTyping=(new Date).getTime(),!0}}},{key:"stopTyping",value:function(){var e=this;if(this.lastStopTyping<(new Date).getTime()-1e4){var t=a.default.getInstance().transportManager.send({t:"group_channels.stop_typing",d:{id:this.id}});return this.toFunc=function(n){return window.setTimeout(function(){a.default.getInstance().off("to."+t,e.toFunc)},0),cb(null,n)},this.lastStopTyping=(new Date).getTime(),!0}}},{key:"markAsRead",value:function(){var e=this,t=a.default.getInstance().transportManager.send({t:"group_channels.read",d:{id:this.id}});return this.toFunc=function(n){return window.setTimeout(function(){a.default.getInstance().off("to."+t,e.toFunc)},0),cb(null,n)},!0}},{key:"getReadReceipt",value:function(e){return this.readReceipt}},{key:"getUnreadMessageCount",value:function(){return this.unreadMessageCount}},{key:"getCurrentUserReadStatus",value:function(){if(this.lastMessage){var e=this.lastMessage.inserted_at;return this.readReceipt[a.default.getInstance().user.id]>=e}return!0}},{key:"getTypingParticipants",value:function(){var e=[];for(var t in this.cachedParticipantsTypingStatus)for(var n in this.participants)if(t===this.participants[n].id){e.push(this.participants[n]);break}return e}}],[{key:"create",value:function(e,t,n,r){var o=this,i=a.default.getInstance().transportManager.send({t:"group_channels.create",d:{name:e,participant_ids:t,is_distinct:n}});return this.toFunc=function(e){return a.default.getInstance().GroupChannel.cachedChannels||(a.default.getInstance().GroupChannel.cachedChannels=[]),a.default.getInstance().GroupChannel.cachedChannels[e.getId()]=e,window.setTimeout(function(){a.default.getInstance().off("to."+i,o.toFunc)},0),r(null,e)},a.default.getInstance().on("to."+i,this.toFunc),!0}},{key:"get",value:function(e,t){return a.default.getInstance().GroupChannel.cachedChannels&&a.default.getInstance().GroupChannel.cachedChannels[e]?t(null,a.default.getInstance().GroupChannel.cachedChannels[e]):this._getFromServer(e,t)}},{key:"_getFromServer",value:function(e,t){var n=this,r=a.default.getInstance().transportManager.send({t:"group_channels.get",d:{id:e}});return this.toSuccessFunc=function(e){return a.default.getInstance().GroupChannel.cachedChannels||(a.default.getInstance().GroupChannel.cachedChannels=[]),a.default.getInstance().GroupChannel.cachedChannels[e.getId()]=e,window.setTimeout(function(){a.default.getInstance().off("to."+r+".success",n.toSuccessFunc),a.default.getInstance().off("to."+r+".error",n.toErrorFunc)},0),t(null,e)},this.toErrorFunc=function(e){var o=new c.default(e);return window.setTimeout(function(){a.default.getInstance().off("to."+r+".success",n.toSuccessFunc),a.default.getInstance().off("to."+r+".error",n.toErrorFunc)},0),t(o,null)},a.default.getInstance().on("to."+r+".success",this.toSuccessFunc),a.default.getInstance().on("to."+r+".error",this.toErrorFunc),!0}}]),i(e,[{key:"getId",value:function(){return this.id}},{key:"getName",value:function(){return this.name}},{key:"createPreviousMessageListQuery",value:function(){return new p.default(this)}},{key:"refresh",value:function(){}}],[{key:"createGroupChannelListQuery",value:function(){return new f.default}}]),e}();t.default=v},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){r(this,e),this.code=t.code,this.message=t.message}return o(e,[{key:"getMessage",value:function(){return this.message}},{key:"getCode",value:function(){return this.code}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),s=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(){function e(t){r(this,e),this.channelType="group",this.groupChannel=t}return o(e,[{key:"load",value:function(e,t,n){var r=this,o=void 0;return"open"==this.channelType?o=s.default.getInstance().transportManager.send({t:"open_channels.history",d:{id:this.openChannel.getId()}}):"group"==this.channelType&&(o=s.default.getInstance().transportManager.send({t:"group_channels.history",d:{id:this.groupChannel.getId(),limit:e,reference:t}})),this.toFunc=function(e){return window.setTimeout(function(){s.default.getInstance().off("to."+o,r.toFunc)},0),n(null,e)},s.default.getInstance().on("to."+o,this.toFunc),!0}}]),e}();t.default=a},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(3),u=function(e){return e&&e.__esModule?e:{default:e}}(a),c=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return e.status&&(i.status=e.status),i}return i(t,e),s(t,[{key:"getInvitationState",value:function(){}}]),t}(u.default);t.default=c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function e(){r(this,e),this.onOpenChannelMessageReceived=function(e,t){},this.onGroupChannelMessageReceived=function(e,t){},this.onGroupChannelTypingStatusChanged=function(e){},this.onGroupChannelReadStatusUpdated=function(e){},this.onGroupChannelUpdated=function(e){},this.onOpenChannelTypingStatusChanged=function(e){}};t.default=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),s=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(){function e(){r(this,e)}return o(e,[{key:"load",value:function(e){var t=this,n=void 0,r=void 0,o=void 0;return r=this.limit?this.limit:5,o=this.reference?this.reference:null,n=s.default.getInstance().transportManager.send({t:"users.list",d:{limit:r,reference:o}}),this.toFunc=function(r){return window.setTimeout(function(){s.default.getInstance().off("to."+n,t.toFunc)},0),console.log(r[r.length-1]),t.reference=r[r.length-1].id,console.log(t),e(null,r)},s.default.getInstance().on("to."+n,this.toFunc),!0}}]),e}();t.default=a}])});